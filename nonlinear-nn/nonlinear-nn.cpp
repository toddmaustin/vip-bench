/*
 *
 */


#include <stdio.h>
#include <stdlib.h>
#include <iostream>
#include <vector>
#include <iomanip>
using namespace std;

#include "../config.h"

// test data
extern vector<double> inputs;
#define A 0.01 //0 < a < 1


VIP_ENCDOUBLE
ReLU(VIP_ENCDOUBLE x)
{
  VIP_ENCDOUBLE ret; 
#ifdef VIP_DO_MODE 
  ret = VIP_CMOV((x > 0), (x), (VIP_ENCDOUBLE)0);
#else
  ret = (x > 0) ? x : 0;
#endif
  return ret;
}

VIP_ENCDOUBLE
LeakyReLU(VIP_ENCDOUBLE x)
{
  VIP_ENCDOUBLE ret; 
#ifdef VIP_DO_MODE 
  ret = (VIP_CMOV((x > 0), x, (VIP_ENCDOUBLE)A*x));
#else
  ret = (x > 0) ? x : A*x;
#endif
  return ret;
}




int
main(void) 
{ 
  VIP_INIT; 
  cout << fixed;
  cout << setprecision(5);

  {
    Stopwatch s("VIP_Bench Runtime");
    for (int i=0; i<1000; i++){
      VIP_ENCDOUBLE x = inputs[i]; 
      cout << "INFO: ReLU("      << inputs[i] << ") == " << VIP_DEC(ReLU(x))      << endl;
      cout << "INFO: LeakyReLU(" << inputs[i] << ") == " << VIP_DEC(LeakyReLU(x)) << endl;
    }
  }

	return 0; 
} 

// tuck the test data at the end of the file
std::vector<double> inputs = {1.250000, 0.200000, -1.666667, -2.166667, -1.928571, 
-0.750000, 2.166667, -3.142857, -1.785714, -3.000000, 
1.000000, -0.400000, -0.538462, 2.800000, 2.000000, 
-3.250000, 0.000000, 13.000000, -1.571429, 1.545455, 
0.200000, -0.933333, 1.583333, -3.666667, 1.000000, 
-0.454545, 7.500000, 3.000000, -0.384615, 0.214286, 
0.416667, 1.777778, -2.833333, -2.571429, 1.750000, 
-0.400000, -1.500000, 1.000000, 13.000000, 3.750000, 
-3.250000, -1.200000, -2.857143, -2.571429, -0.727273, 
2.500000, -2.363636, -3.833333, 0.363636, 1.142857, 
0.000000, 0.000000, -1.571429, -0.166667, -1.545455, 
1.000000, 0.500000, 1.666667, 0.333333, -0.857143, 
-1.428571, 8.000000, 0.666667, -0.750000, 0.375000, 
-2.833333, -1.769231, 1.000000, -2.181818, -0.800000, 
-2.000000, 0.400000, 0.125000, 9.000000, -0.857143, 
-3.500000, -1.000000, 1.333333, 5.500000, 0.000000, 
0.600000, 0.125000, 0.666667, -1.777778, 0.250000, 
3.750000, 6.500000, -2.692308, -1.800000, 2.500000, 
-1.750000, -3.500000, 1.000000, -1.909091, 2.500000, 
-0.500000, 15.000000, -2.400000, -0.818182, -0.500000, 
-2.000000, -2.166667, -1.307692, -2.714286, -0.846154, 
-1.272727, -1.875000, -1.142857, 0.300000, -1.750000, 
-0.833333, 0.500000, -2.500000, -1.800000, -0.666667, 
-0.444444, 2.857143, -0.272727, -1.181818, 0.250000, 
-1.666667, -1.571429, -3.250000, -1.600000, -2.384615, 
2.500000, -2.500000, 1.750000, 2.000000, -1.750000, 
-1.583333, 1.500000, -2.785714, -2.000000, -0.500000, 
-1.222222, 2.800000, -2.000000, 1.272727, 0.714286, 
-2.625000, 3.000000, -0.454545, -1.909091, -2.625000, 
-0.333333, -2.666667, -1.571429, -1.666667, 0.642857, 
-1.444444, 3.800000, -0.375000, -1.500000, 4.500000, 
-0.833333, -1.714286, 0.333333, -2.181818, 1.111111, 
0.500000, -0.181818, -1.166667, 5.000000, 6.500000, 
-1.266667, 0.357143, -0.500000, -2.166667, -2.333333, 
-2.933333, -0.384615, 0.750000, 7.500000, 1.500000, 
1.090909, 1.571429, 0.300000, 0.200000, -3.714286, 
-1.666667, -0.857143, 0.500000, -2.000000, -3.357143, 
1.142857, -1.750000, -1.750000, -2.461538, -1.363636, 
-1.000000, 1.000000, -1.750000, -1.833333, 0.250000, 
0.066667, -1.500000, -0.750000, 1.666667, 1.000000, 
1.800000, -1.500000, 0.250000, -1.200000, -0.727273, 
1.000000, 3.000000, 0.250000, -2.900000, -0.300000, 
-2.000000, 4.000000, -3.000000, -0.750000, 1.000000, 
-2.714286, -1.733333, -1.888889, -2.714286, -0.615385, 
1.428571, -1.545455, -1.750000, -0.900000, -1.000000, 
-1.666667, 6.000000, -1.714286, 0.400000, -0.142857, 
1.000000, -0.666667, 12.000000, 1.000000, 3.333333, 
0.250000, 1.444444, 3.000000, -0.600000, -0.250000, 
2.333333, -2.000000, -2.500000, 1.000000, -3.500000, 
0.090909, 0.333333, -0.888889, 0.875000, 1.750000, 
-2.000000, -1.000000, -0.636364, 0.333333, -3.181818, 
9.000000, -3.333333, -1.250000, -0.375000, 2.200000, 
10.000000, -2.142857, 0.857143, -0.500000, 1.428571, 
-1.000000, 19.000000, 3.500000, -0.363636, 7.500000, 
-2.333333, 0.800000, -0.571429, -1.800000, 9.000000, 
-1.125000, 1.461538, -2.250000, -1.866667, -0.666667, 
-0.416667, -2.750000, -3.800000, -3.222222, 3.000000, 
-3.222222, -2.230769, 2.666667, -2.571429, -2.571429, 
-1.777778, -3.272727, 0.250000, -2.000000, -2.800000, 
0.750000, 5.000000, -2.384615, -3.000000, -0.700000, 
-1.000000, -1.461538, -0.750000, -0.333333, -1.250000, 
0.800000, -1.166667, -2.769231, 5.000000, -0.500000, 
0.000000, 1.545455, 1.166667, 3.333333, -0.750000, 
-1.800000, 0.000000, -0.333333, 0.500000, 5.000000, 
1.400000, 0.375000, 0.000000, -0.571429, -3.428571, 
0.461538, 4.000000, 5.500000, -1.000000, -2.583333, 
2.600000, 0.250000, 0.600000, -0.571429, 4.500000, 
0.000000, -3.714286, -0.800000, -1.923077, -0.714286, 
8.000000, -2.266667, 4.000000, 0.857143, 10.000000, 
8.500000, -2.200000, -0.666667, -0.666667, 0.222222, 
-0.714286, -1.111111, 5.000000, -0.500000, -0.142857, 
2.666667, 2.000000, -0.875000, -3.571429, 3.500000, 
0.666667, 0.285714, 11.000000, 3.600000, 0.000000, 
8.000000, -0.153846, 1.000000, -1.500000, -3.666667, 
-3.133333, -1.250000, 8.000000, 1.000000, -1.818182, 
5.500000, -3.285714, -2.928571, -3.636364, -2.866667, 
-1.916667, -0.714286, -1.933333, -1.571429, -0.833333, 
0.333333, -0.714286, 0.000000, 2.333333, -1.142857, 
14.000000, -3.333333, -3.000000, -3.777778, 5.500000, 
-0.333333, -1.000000, 0.000000, 1.454545, -0.250000, 
12.000000, -2.750000, 11.000000, 0.666667, 2.400000, 
3.500000, 0.700000, -0.142857, 0.000000, 1.600000, 
0.857143, -2.454545, -2.928571, 14.000000, 0.714286, 
-2.000000, -3.250000, 5.000000, -0.384615, 2.500000, 
0.750000, -0.153846, -3.416667, -3.133333, -1.266667, 
-2.428571, -2.642857, -3.466667, 4.000000, -0.714286, 
-1.166667, -2.222222, -1.600000, -3.625000, -2.846154, 
-2.900000, 0.000000, -1.625000, 1.250000, 2.000000, 
-0.333333, 5.000000, -0.700000, 2.142857, 0.733333, 
-3.545455, -3.000000, -2.600000, 4.750000, 18.000000, 
0.571429, 0.100000, 1.285714, 6.000000, 0.166667, 
-2.066667, -0.454545, 0.000000, 1.333333, -2.461538, 
-2.600000, 2.000000, -2.875000, -3.333333, 1.333333, 
0.625000, -2.000000, -1.909091, -0.900000, -2.307692, 
0.857143, 0.272727, -2.857143, 0.500000, -2.250000, 
-1.000000, -2.090909, -2.666667, 1.000000, -0.571429, 
1.800000, -0.230769, 0.250000, 1.200000, -0.750000, 
-1.111111, 2.000000, -1.666667, 2.333333, -1.500000, 
-0.500000, -1.333333, -0.800000, -1.250000, -1.000000, 
-0.100000, 1.076923, -3.000000, -3.571429, 6.333333, 
1.666667, 0.933333, 5.000000, -2.250000, -0.400000, 
0.600000, 1.500000, -2.666667, 0.230769, 4.666667, 
-2.833333, -1.692308, 1.000000, -2.857143, 2.000000, 
5.000000, 1.600000, -0.250000, 13.000000, -2.444444, 
0.615385, -3.714286, -3.000000, -1.125000, -0.571429, 
1.000000, -1.076923, -3.333333, -0.333333, 1.000000, 
-3.900000, -1.428571, 1.000000, -1.714286, 0.266667, 
0.666667, 1.428571, 4.333333, 3.666667, 0.400000, 
3.000000, 1.285714, 17.000000, -0.571429, -0.571429, 
-0.500000, -0.750000, 1.142857, -0.333333, 3.000000, 
-3.000000, -0.400000, 9.000000, -0.545455, -3.000000, 
4.000000, 0.428571, -1.071429, -2.923077, 3.000000, 
1.250000, 6.000000, 1.833333, -2.700000, -2.916667, 
4.666667, 1.000000, -2.500000, 0.700000, 3.000000, 
1.666667, 0.750000, 1.800000, -3.928571, 0.400000, 
-0.181818, -0.600000, 1.400000, 17.000000, -3.769231, 
-0.500000, -2.833333, -1.100000, 3.000000, -0.375000, 
2.857143, 1.666667, 18.000000, -2.625000, 0.384615, 
1.555556, 5.500000, -1.818182, -2.000000, 0.357143, 
1.600000, 2.222222, 7.000000, -1.666667, 6.000000, 
-3.714286, 0.333333, 0.733333, -2.615385, 1.333333, 
2.000000, -2.500000, 0.727273, 2.142857, -2.750000, 
0.600000, -2.555556, 1.818182, -1.600000, -0.928571, 
-0.875000, -3.400000, 1.214286, -2.400000, 4.000000, 
0.333333, -1.800000, -1.000000, -2.333333, 0.500000, 
0.692308, -0.636364, -1.400000, 5.000000, -1.769231, 
-3.181818, 11.000000, 1.428571, -2.818182, 1.307692, 
-3.285714, -3.000000, -1.818182, 0.750000, -2.666667, 
0.636364, -3.307692, -1.500000, -0.700000, 3.333333, 
-1.500000, -0.846154, 0.166667, -0.200000, 4.000000, 
2.000000, -0.285714, -2.000000, 0.333333, -1.200000, 
-1.888889, -0.333333, 8.000000, -1.357143, 13.000000, 
0.500000, 1.000000, -2.642857, -3.500000, 0.333333, 
-1.500000, 2.500000, 18.000000, -2.363636, -3.600000, 
2.857143, -2.500000, -2.666667, -0.750000, -0.500000, 
-1.600000, 0.000000, -1.750000, 2.166667, -3.846154, 
-0.444444, 3.333333, 3.000000, 3.000000, 4.500000, 
-0.600000, -0.333333, -0.600000, -1.666667, 0.090909, 
2.833333, -2.500000, 0.428571, 0.076923, -1.846154, 
-2.000000, -1.400000, 0.214286, -1.000000, -1.428571, 
4.000000, 11.000000, 1.333333, 1.125000, -1.571429, 
-0.666667, -2.125000, 1.428571, -0.533333, -0.357143, 
7.000000, 3.166667, -0.875000, 1.000000, -2.400000, 
-0.769231, -0.642857, -0.700000, -1.666667, -0.600000, 
-2.666667, 0.700000, -1.250000, 1.125000, -2.500000, 
16.000000, -0.400000, 4.000000, -2.272727, 0.888889, 
-2.666667, -3.400000, -2.166667, -1.100000, -2.266667, 
1.000000, 1.500000, -0.916667, -0.636364, 0.800000, 
-1.222222, -0.307692, 1.750000, -1.444444, -3.866667, 
0.000000, -0.636364, -2.545455, -0.222222, 2.000000, 
1.500000, -1.333333, 0.090909, -3.000000, 1.200000, 
-0.583333, 0.000000, -1.900000, -1.222222, -2.555556, 
-2.181818, -2.900000, 0.333333, 1.333333, 1.300000, 
8.000000, -0.300000, -0.500000, 0.000000, -0.533333, 
-0.466667, 5.500000, -1.916667, -1.200000, -1.500000, 
9.000000, -3.266667, 1.222222, 1.500000, 0.875000, 
-0.833333, 2.400000, 6.500000, 3.166667, -1.714286, 
1.000000, 0.500000, 11.000000, 0.166667, 1.000000, 
-2.923077, 15.000000, 9.000000, -1.833333, 3.000000, 
-2.000000, 3.333333, 0.600000, -2.500000, -1.000000, 
1.500000, 3.500000, -3.357143, -3.461538, -3.200000, 
0.133333, -2.142857, -2.923077, 1.500000, 1.500000, 
-0.333333, 14.000000, 0.777778, 0.000000, 1.400000, 
-0.500000, -3.857143, 1.000000, 0.666667, 13.000000, 
-2.333333, 3.250000, -1.500000, 1.538462, -3.000000, 
-3.466667, -1.416667, 3.333333, -1.714286, 0.285714, 
3.000000, -3.583333, -0.857143, 0.900000, -1.800000, 
-2.571429, 0.285714, -2.818182, -2.777778, 0.214286, 
1.625000, -2.142857, 0.000000, -2.600000, -1.600000, 
-2.000000, -3.181818, 2.142857, 1.000000, -1.846154, 
1.666667, 6.000000, -3.200000, -2.400000, -1.555556, 
3.333333, 1.214286, -2.466667, 8.000000, -0.666667, 
5.000000, 0.750000, 12.000000, -0.461538, -1.857143, 
0.285714, -0.230769, 0.714286, 4.500000, 0.181818, 
-0.636364, -0.428571, -2.928571, -0.200000, 20.000000, 
0.571429, -0.833333, -0.400000, -1.300000, 0.538462, 
2.250000, -1.700000, 4.000000, 2.000000, -0.307692, 
-3.307692, 0.250000, -0.125000, -0.785714, 0.285714, 
-3.600000, 1.375000, 0.500000, -2.555556, 1.400000, 
-1.333333, 1.666667, -2.250000, -0.750000, -3.000000, 
-2.888889, 0.200000, 0.000000, -0.727273, 11.000000, 
-2.866667, -2.000000, -2.666667, 5.000000, 6.000000, 
-0.181818, 10.000000, -0.750000, 0.230769, 3.500000, 
0.692308, -1.333333, -2.000000, 6.500000, -1.500000, 
6.000000, 6.500000, 3.000000, 1.800000, -0.500000, 
4.000000, -0.888889, -1.750000, 0.500000, 0.250000, 
-1.615385, -2.800000, -0.200000, -1.500000, 3.166667, 
-2.125000, -0.357143, -1.714286, -0.600000, -0.888889, 
1.166667, -0.400000, 0.307692, 1.000000, -1.307692, 
-0.545455, 0.833333, -0.250000, -1.461538, -1.500000, 
-2.285714, -0.333333, -1.142857, 1.727273, -3.111111, 
3.500000, 1.666667, -2.666667, -1.400000, 0.833333, 
-0.400000, -1.272727, 2.250000, 5.666667, -1.466667, 
4.000000, -2.250000, 1.600000, -3.000000, 2.666667, 
1.625000, -1.000000, 1.000000, 0.750000, 9.000000, 
15.000000, -2.500000, -1.250000, -0.416667, -2.750000, 
0.400000, 1.272727, 13.000000, -1.307692, 2.750000, 
-0.545455, 0.142857, 4.000000, 0.111111, -3.888889, 
-3.416667, -0.800000, -1.142857, -1.416667, 0.600000, 
-1.125000, -0.285714, -1.000000, -1.923077, -1.900000};
